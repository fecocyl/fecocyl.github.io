<!DOCTYPE html>
<html lang="en">
    <head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Palomares Castilla y Le&oacute;n</title>
		<!-- Favicon-->
		<link rel="icon" href="img/favicon.png" type="image/png">
		
		<!--Leaflet-->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A==" crossorigin=""/>
		<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin=""></script>
		
		<!--Leaflet UTM-->
		<script src="js/L.LatLng.UTM.js"></script>

		<!--Esri Leaflet-->
		<script src="https://unpkg.com/esri-leaflet@2.2.3/dist/esri-leaflet.js" integrity="sha512-YZ6b5bXRVwipfqul5krehD9qlbJzc6KOGXYsDjU9HHXW2gK57xmWl2gU6nAegiErAqFXhygKIsWPKbjLPXVb2g==" crossorigin=""></script>

		<!--Esri Leaflet Geocoder-->
		<link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.2.13/dist/esri-leaflet-geocoder.css" integrity="sha512-v5YmWLm8KqAAmg5808pETiccEohtt8rPVMGQ1jA6jqkWVydV5Cuz3nJ9fQ7ittSxvuqsvI9RSGfVoKPaAJZ/AQ==" crossorigin="">
		<script src="https://unpkg.com/esri-leaflet-geocoder@2.2.13/dist/esri-leaflet-geocoder.js" integrity="sha512-zdT4Pc2tIrc6uoYly2Wp8jh6EPEWaveqqD3sT0lf5yei19BC1WulGuh5CesB0ldBKZieKGD7Qyf/G0jdSe016A==" crossorigin=""></script>
				
		<!--jQuery-->
		<script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

		<!--Bootstrap-->
		<!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">-->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
		
		<!--Bootstrap-icons-->
		<!--<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">-->
		
		<!--Bootstrap-slider-->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/11.0.2/bootstrap-slider.min.js" integrity="sha512-f0VlzJbcEB6KiW8ZVtL+5HWPDyW1+nJEjguZ5IVnSQkvZbwBt2RfCBY0CBO1PsMAqxxrG4Di6TfsCPP3ZRwKpA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<!-- Da un error con la última línea del fichero /*# sourceMappingURL=bootstrap.css.map */ 
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/11.0.2/css/bootstrap-slider.min.css" integrity="sha512-3q8fi8M0VS+X/3n64Ndpp6Bit7oXSiyCnzmlx6IDBLGlY5euFySyJ46RUlqIVs0DPCGOypqP8IRk/EyPvU28mQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />-->
		<link rel="stylesheet" href="css/bootstrap-slider.min.css">
		
		<!--Font-awesome-->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
		
		<!--Datatables-->
		<script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>
		<link rel="stylesheet" href="https://cdn.datatables.net/1.11.4/css/jquery.dataTables.min.css">
		<!--<script src="https://cdn.datatables.net/1.11.4/js/dataTables.bootstrap5.min.js"></script>-->
		<!--<link rel="stylesheet" href="https://cdn.datatables.net/1.11.4/css/dataTables.bootstrap5.min.css">-->
		
		<!--Ajax-->
		<script src="js/leaflet.ajax.min.js"></script>
		
		<!--Leaflet Spain-->
		<script src="https://sigdeletras.github.io/Leaflet.Spain.WMS/src/Leaflet.Spain.WMS.js"></script>

		<!--Mapas-->
		<script type="text/javascript" src="js/mapas.js"></script>
		
		<!--Turf-->
		<script src='https://unpkg.com/@turf/turf@6/turf.min.js'></script>

		<!-- Core theme CSS (includes Bootstrap)-->
		<link rel="stylesheet" href="css/styles.css" />

		<link rel="stylesheet" href="css/main.css" />
		
	</head>
	<body>
		<div class="d-flex" id="wrapper">
			<!--sidebar-->
			<div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling" aria-labelledby="offcanvasScrollingLabel">
				<div class="offcanvas-header vertical-center bg-secondary text-white">
					<!--<h4 class="offcanvas-title" id="offcanvasScrollingLabel"><i class="fa fa-cog fa-2x" aria-hidden="true"></i> Distancias</h4>-->
					<h4 class="offcanvas-title" id="offcanvasScrollingLabel"><span class="fa-stack fa-lg"><i class="fa fa-map-marker fa-stack-2x"></i></span> Distancias</h4>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Cerrar" data-bs-placement="bottom" title="Cerrar" data-bs-placement="bottom" title="Cerrar"></button>
				</div>
				<div class="offcanvas-body">
					<div class="list-group list-group-flush">
						<div id="wrap">
							<div id="selectanio">
								<div class="header"><h5> A&ntilde;o</h5></div>
								<div class="form-group" style="margin:10px 10px;">
									<select id="anio" class="form-select" name="anio">
										<!--<option value="-1">Seleccione a&ntilde;o</option>
										<option value="2021">2021</option>
										<option value="2022">2022</option>-->
									</select>
								</div>
							</div>
							<div id="selectprovincia">
								<div class="header"><h5> Palomares</h5></div>
								<div class="form-group" style="margin:10px 10px;">
									<select id="provincia" class="form-select" name="provincia">
									<!--<option value="">Seleccione provincia</option>
										<option value="24">Le&oacute;n</option>
										<option value="37">Salamanca</option>
										<option value="47">Valladolid</option>
										<option value="49">Zamora</option>-->
									</select>
								</div>
							</div>
							<div id="selectclub">
								<div class="form-group" style="margin:10px 10px;">
									<select id="club" class="form-select" name="club">
										<!--<option value="">Seleccione un club</option>-->
									</select>
								</div>
							</div>		
							<div id="selectsocio">
								<div class="form-group" style="margin:10px 10px;">
									<div class="input-group w-100">
										<select id="socio" class="form-select w-75" name="socio" aria-label="">
											<!--option value="">Seleccione socio</option>-->
										</select>
										<!--<span>&nbsp;<button id="centrarpalomar" class="btn btn-primary" aria-label="Centrar palomar"><i class="fa fa-map-marker fa-lg" aria-hidden="true"></i></button></span>-->
										<span>&nbsp;<button id="centrarpalomar" class="btn btn-outline-dark" aria-label="Centrar palomar" data-bs-placement="bottom" title="Centrar palomar"><i class="fa fa-map-marker fa-lg" aria-hidden="true"></i></button></span>
									</div>
								</div>
							</div>
							<br />
							<div id="selectsuelta">
								<div class="header"><h5> Puntos de suelta</h5></div>
									<div class="form-group" style="margin:10px 10px;">
										<div class="input-group w-100">
										<select id="psuelta" class="form-select w-75" name="psuelta" aria-label="">
											<!--option value="">Seleccione punto de suelta</option>-->
										</select>
										<!--<span>&nbsp;<button id="centrarsuelta" class="btn btn-primary" aria-label="Centrar suelta"><i class="fa fa-map-marker fa-lg" aria-hidden="true"></i></button></span>-->
										<span>&nbsp;<button id="centrarsuelta" class="btn btn-outline-dark" aria-label="Centrar suelta" data-bs-placement="bottom" title="Centrar suelta"><i class="fa fa-map-marker fa-lg" aria-hidden="true"></i></button></span>
									</div>
								</div>
							</div>
							<div id="infopsuelta" class="form-group" style="margin:10px 10px;">
								Doble click en el mapa para marcar un punto
							</div>
							<div class="d-grid gap-2"style=" margin:10px 10px;">
								<!--<button id="btn_distancia" type="button" class="btn btn-primary btn-lg">Distancia</button>-->
								<button id="btn_distancia" type="button" class="btn btn-outline-dark btn-lg" data-bs-placement="bottom" title="Calcular distancias">Distancia</button>
							</div>

							<div id="datosdistancia" class="form-group" style="margin:10px 10px;">

								<div class="accordion" id="datosdistanciaacordeon">
									<div class="accordion-item">
										<h2 class="accordion-header" id="panelsStayOpen-headingOne">
											<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseOne" aria-expanded="true" aria-controls="panelsStayOpen-collapseOne" data-bs-placement="bottom" title="Cálculo de distancias por Pitágoras">
												Pitágoras
											</button>
										</h2>
									
										<div id="panelsStayOpen-collapseOne" class="accordion-collapse collapse show" aria-labelledby="panelsStayOpen-headingOne">
											<div class="accordion-body">
												<div class="panel-title pull-right" style="margin:10px 10px;">
													<!--<a class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal"><i class="fa fa-file-text-o" aria-hidden="true"></i></a>-->
													<a id="reportpitagoras" class="btn btn-outline-dark" data-bs-toggle="modal" data-bs-target="#ModalPitagoras" data-bs-placement="bottom" title="Informe de distancias por Pitágoras"><i class="fa fa-file-text-o" aria-hidden="true"></i></a>
												</div>
												<div id="datosdistancia_pitagoras" class="panel-body"></div>
											</div>
										</div>
									</div>
									<div class="accordion-item">
										<h2 class="accordion-header" id="panelsStayOpen-headingTwo">
											<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#panelsStayOpen-collapseTwo" aria-expanded="false" aria-controls="panelsStayOpen-collapseTwo" data-bs-placement="bottom" title="Cálculo de distancias por Haversine">
												Haversine
											</button>
										</h2>
										<div id="panelsStayOpen-collapseTwo" class="accordion-collapse collapse" aria-labelledby="panelsStayOpen-headingTwo">
											<div class="accordion-body">
												<div class="panel-title pull-right" style="margin:10px 10px;">
													<!--<a class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal"><i class="fa fa-file-text-o" aria-hidden="true"></i></a>-->
													<a id="reporthaversine" class="btn btn-outline-dark" data-bs-toggle="modal" data-bs-target="#ModalHaversine" data-bs-placement="bottom" title="Informe de distancias por Haversine"><i class="fa fa-file-text-o" aria-hidden="true"></i></a>
												</div>
												<div id="datosdistancia_haversine" class="panel-body"></div>
											</div>
										</div>
									</div>
								</div>

							</div> <!--datosdistancia-->
					
						</div>
					</div>		
				</div>
			
			</div> <!--sidebar-->

			<!--sidebar2-->
			<div class="offcanvas offcanvas-start" data-bs-scroll="true" data-bs-backdrop="false" tabindex="-1" id="offcanvasScrolling1" aria-labelledby="offcanvasScrollingLabel1">
				<div class="offcanvas-header vertical-center bg-secondary text-white">
					<!--<h4 class="offcanvas-title" id="offcanvasScrollingLabel1"><i class="fa fa-cog fa-2x" aria-hidden="true"></i> Opciones</h4>-->
					<h4 class="offcanvas-title" id="offcanvasScrollingLabel1"><span class="fa-stack fa-lg"><i class="fa fa-cog fa-stack-2x"></i></span> Opciones</h4>
					<button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Cerrar" data-bs-placement="bottom" title="Cerrar"></button>
				</div>
				<div class="offcanvas-body">
					<div class="list-group list-group-flush">
						<div id="wrap">
							<div id="selectanio_settings">
								<div class="header"><h5> A&ntilde;o</h5></div>
								<div style="padding-left:64px;">
									<!--<input id="aniosettings" data-slider-id='ex1Slider' type="text" data-slider-min="2021" data-slider-max="2022" data-slider-step="1" data-slider-value="2022" style="width:272px;" />-->
									<input id="aniosettings" data-slider-id='ex1Slider' type="text" data-slider-step="1" style="width:272px;" disabled />
								</div>
							</div>
							<div id="selectradio">
								<!--<br /><div class="header"><h5> Radio Tierra <i class="fa fa-info-circle fa-1x" aria-hidden="true" title="Seleccionar el radio de la tierra para el cálculo de distancias por Haversine"></i></h5></div>-->
								<br /><div class="header"><h5> Radio Tierra <span id='clickableAwesomeFont'><a href="https://en.wikipedia.org/wiki/Earth_radius" target="_blank"><i class="fa fa-info-circle fa-1x" title="Seleccionar el radio de la tierra para el cálculo de distancias por Haversine"></i></a></h5></span></div>
								<div class="form-group" style="margin:10px 10px;">
									<select id="radio" class="form-select" name="radio">
										<option value="-1" selected>Distancia Leaflet (6371 km)</option>
										<option value="0">Media (6371.0088 km)</option>
										<option value="1">Ecuador (6378.1370 km)</option>
									</select>
								</div>
							</div>
							<div id="selectcentro">
								<div class="header"><h5> Centro</h5></div>
								<div class="form-group" style="margin:10px 10px;">
									<select id="centro" class="form-select" name="centro">
										<option value="">Seleccione centro</option>
										<option value="0">Centro de la provincia</option>
										<option value="1">Elegir palomar como centro</option>
										<option value="2">Centro de todos los palomares</option>
										<option value="3">Centro en el palomar más cercano</option>
									</select>
								</div>
							</div>
							<div id="selectmartir">
								<div class="form-group" style="margin:10px 10px;">
									<div class="input-group w-100">
										<select id="martir" class="form-select w-75" name="martir" aria-label="">
										</select>
										<span>&nbsp;<button id="centrarradio" class="btn btn-outline-dark" aria-label="Centrar Radio" data-bs-placement="bottom" title="Centrar Radio"><i class="fa fa-map-marker fa-lg" aria-hidden="true"></i></button></span>
									</div>
								</div>
							</div>

							<div id="distanciaradio">
								<div class="header"><h5> Distancia</h5></div>
								<div class="input-group" style="margin:10px 10px;">
									<div class="input-group-prepend">
										<span class="input-group-text" id="basic-addon1">Radio</span>
									</div>
									<div style="width: 139px;"> <!--sin boton 234px, con 1 186-->
										<input id="rad_distancia" type="number" class="form-control" min="1" max="3000" step="1" value="200">
									</div>
									<div class="input-group-append">
										<span class="input-group-text">Km</span>
									</div>
									<div class="input-group-append">
										<span>&nbsp;<button id="circlemap" class="btn btn-outline-dark" aria-label="Marcar en el mapa" data-bs-placement="bottom" title="Marcar en el mapa"><i class="fa fa-arrow-circle-right fa-lg" aria-hidden="true"></i></button> <button id="delcirclemap" class="btn btn-outline-dark" aria-label="Borrar del mapa" data-bs-placement="bottom" title="Borrar del mapa"><i class="fa fa-trash fa-lg" aria-hidden="true"></i></button></span>
									</div>
								</div>
							</div>
							

						</div>
					</div>
				</div>
			
			</div> <!--sidebar2-->
			
			<!--mapa y contenido principal-->
			<div id="page-content-wrapper">
				
				<!--Barra navegación superior-->
				<!--<nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">-->
				<nav class="navbar navbar-expand-lg navbar-dark bg-dark border-bottom">
					<div class="container-fluid">
						<div>
							<!--<button class="btn btn-primary" id="sidebarToggle" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasScrolling" aria-controls="offcanvasScrolling">Distancias <i class="fa fa-arrow-right" aria-hidden="true"></i></button>-->
							<button class="btn btn-outline-light" id="sidebarToggle" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasScrolling" aria-controls="offcanvasScrolling" data-bs-placement="bottom" title="Cálculo de distancias">Distancias <i class="fa fa-arrow-right" aria-hidden="true"></i></button>&nbsp;
-							<!--<button class="btn btn-outline-light" id="sidebarToggle1" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasScrolling1" aria-controls="offcanvasScrolling"> data-bs-placement="bottom" title="Opciones de distancias">&nbsp;Opciones <i class="fa fa-arrow-right" aria-hidden="true"></i></button>-->
						</div>
<!--ORIGINAL
						<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
-->						
<!--					<button class="navbar-toggler ml-auto" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
						<div class="collapse navbar-collapse" id="navbarSupportedContent">
							<ul class="navbar-nav ms-auto mt-2 mt-lg-0">
								<li class="nav-item"><a class="nav-link" href="#!">Menú 1</a></li>
								<li class="nav-item"><a class="nav-link" href="#!">Menú 2</a></li>
								<li class="nav-item dropdown">
									<a class="nav-link dropdown-toggle" id="navbarDropdown" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Desplegable</a>
									<div class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
										<a class="dropdown-item" href="#!">Opción 1</a>
										<a class="dropdown-item" href="#!">Opción 2</a>
										<div class="dropdown-divider"></div>
										<a class="dropdown-item" href="#!">Opción 3</a>
									</div>
								</li>
								<li class="nav-item">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</li>
							</ul>
						</div>
-->
					</div>
				</nav>
				
				<!--Mapa-->
				<div class="container-fluid">
					<div id="map"></div>
				</div>
				
				<!--Capa modal de distancias Pitágoras-->
				<div class="modal fade" id="ModalPitagoras" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
					<div class="modal-dialog modal-lg">
						<div class="modal-content">

							<!--Cabecera-->
							<div class="modal-header">
								<h4 id="title_table_Pitagoras" class="modal-title"></h4>
								<button type="button" class="btn-close" data-bs-dismiss="modal" data-bs-placement="bottom" title="Cerrar"></button>
							</div>

							<!--Cuerpo-->
							<div class="modal-body">
								<div class="row" style="padding:15px">
									<div class="table-responsive">
										<table id="sortPitagoras" class="display responsive" style="width:100%">
											<thead>
												<tr>
													<th></th>
													<th>Metros</th>
													<th>Kilómetros</th>
												</tr>
											</thead>
											<tbody></tbody>
										</table>
									</div>
								</div>
							</div>

							<!--Pie-->
							<div class="modal-footer justify-content-between">
								<a href="https://es.wikipedia.org/wiki/Distancia_euclidiana" target="_blank">Pitágoras</a>
								<button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal" data-bs-placement="bottom" title="Cerrar">Cerrar</button>
							</div>
							
						</div>
					</div>
				</div>

				<!--Capa modal de distancias Haversine-->
				<div class="modal fade" id="ModalHaversine" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
					<div class="modal-dialog modal-lg">
						<div class="modal-content">

							<!--Cabecera-->
							<div class="modal-header">
								<h4 id="title_table_Haversine" class="modal-title"></h4>
								<button type="button" class="btn-close" data-bs-dismiss="modal" data-bs-placement="bottom" title="Cerrar"></button>
							</div>

							<!--Cuerpo-->
							<div class="modal-body">
								<div class="row" style="padding:15px">
									<div class="table-responsive">
										<table id="sortHaversine" class="display responsive" style="width:100%">
											<thead>
												<tr>
													<th></th>
													<th>Metros</th>
													<th>Kilómetros</th>
												</tr>
											</thead>
											<tbody></tbody>
										</table>
									</div>
								</div>
							</div>

							<!--Pie-->
							<div class="modal-footer justify-content-between">
								<a href="https://es.wikipedia.org/wiki/F%C3%B3rmula_del_semiverseno" target="_blank">Haversine</a>
								<button type="button" class="btn btn-outline-dark" data-bs-dismiss="modal" data-bs-placement="bottom" title="Cerrar">Cerrar</button>
							</div>

						</div>
					</div>
				</div>



				<script type="text/javascript">
					$(document).ready(function(){
						document.getElementById('selectprovincia').style.display='none';
						document.getElementById('selectclub').style.display='none';
						document.getElementById('selectsocio').style.display='none';
						document.getElementById('selectsuelta').style.display='none';
						document.getElementById('btn_distancia').style.display='none';
						document.getElementById('datosdistancia').style.display='none';
						document.getElementById('infopsuelta').style.display='none';
						document.getElementById('selectmartir').style.display='none';
						Procesa();
						
						$('#sortPitagoras').DataTable({
							"order": [[ 2, "asc" ]],
							"columnDefs": [
								{ className: "dt-body-right", "targets": [1,2] },
								{ className: "text-nowrap", "targets": [0] }
							],
							"language": {
								"decimal": ",",
								"sProcessing": "Procesando...",
								"sLengthMenu": "Mostrar _MENU_ registros",
								"sZeroRecords": "No se encontraron resultados",
								"sInfo" : "Mostrando _START_ a _END_ de _TOTAL_ registro(s)",
								"sEmptyTable": "Ningún dato disponible en esta tabla",
								"sInfoEmpty": "Mostrando registros del 0 al 0 de un total de 0 registros",
								"sInfoFiltered": "(filtrado de un total de _MAX_ registros)",
								"sSearch": "Buscar:",
								"sLoadingRecords": "Cargando...",
								"paginate": {
									"first": "Primero",
									"last": "Último",
									"next": "Siguiente",
									"previous": "Anterior"
								}
							}
						});

						$('#sortHaversine').DataTable({
							"order": [[ 2, "asc" ]],
							"columnDefs": [
								{ className: "dt-body-right", "targets": [1,2] },
								{ className: "text-nowrap", "targets": [0] }
							],
							"language": {
								"decimal": ",",
								"sProcessing": "Procesando...",
								"sLengthMenu": "Mostrar _MENU_ registros",
								"sZeroRecords": "No se encontraron resultados",
								"sInfo" : "Mostrando _START_ a _END_ de _TOTAL_ registro(s)",
								"sEmptyTable": "Ningún dato disponible en esta tabla",
								"sInfoEmpty": "Mostrando registros del 0 al 0 de un total de 0 registros",
								"sInfoFiltered": "(filtrado de un total de _MAX_ registros)",
								"sSearch": "Buscar:",
								"sLoadingRecords": "Cargando...",
								"paginate": {
									"first": "Primero",
									"last": "Último",
									"next": "Siguiente",
									"previous": "Anterior"
								}
							}
						});

					});
				
					$('#anio').on('change',function(){ 
						anio = $(this).val();
						document.getElementById('selectprovincia').style.display='none';
						document.getElementById('selectclub').style.display='none';
						document.getElementById('selectsocio').style.display='none';
						document.getElementById('selectsuelta').style.display='none';
						document.getElementById('btn_distancia').style.display='none';
						document.getElementById('datosdistancia').style.display='none';
						MuestraProvincia(0);
						BorrarPalomares();
						BorrarPuntoSuelta();
						//Remove lines from Map
						polylines.forEach(function (item){
							map.removeLayer(item)
						});
						if (anio != -1){
							$("#aniosettings").slider('setValue', anio);
							if (CargarProvincias(anio) > 0){
								document.getElementById('selectprovincia').style.display='block';
							}
							else{
								document.getElementById('selectprovincia').style.display='none';
							}
						}
					});

					$('#provincia').on('change',function(){ 
						var codProv = $(this).val();
						var anio = $('#anio').val();
						if (codProv == -1){
							MuestraProvincia(0);
						}
						document.getElementById('selectclub').style.display='none';
						document.getElementById('selectsocio').style.display='none';
						document.getElementById('selectsuelta').style.display='none';
						document.getElementById('btn_distancia').style.display='none';
						document.getElementById('datosdistancia').style.display='none';
						BorrarPalomares();
						//Remove lines from Map
						polylines.forEach(function (item){
							map.removeLayer(item)
						});
						map.off('dblclick');
						BorrarPuntoSuelta();
						if (codProv!=-1){
							MuestraProvincia(codProv);
							if (CargarClubes(anio,codProv) > 0){
								document.getElementById('selectclub').style.display='block';
								if (cargarSueltas(anio, codProv) > 0){
									$("#centrarsuelta").prop("disabled", true);
									document.getElementById('selectsuelta').style.display='block';
								}
							}
						}
					});

					$('#club').on('change',function(){
						var codClub = $(this).val();
						var codProv = $('#provincia').val();
						var anio = $('#anio').val();
						document.getElementById('btn_distancia').style.display='none';
						document.getElementById('datosdistancia').style.display='none';
						BorrarPalomares();
						//Remove lines from Map
						polylines.forEach(function (item){
							map.removeLayer(item)
						});
						map.off('dblclick');
						//BorrarPuntoSuelta();
						//$("#psuelta").val("-1").change();
						$("#centrarpalomar").prop("disabled", true);
						if (codClub > 0){
							if (CargarSocios(anio,codProv,codClub) > 0){
								document.getElementById('selectsocio').style.display='block';
								Centrar(codProv, "1");
							}
						} else {
							document.getElementById('selectsocio').style.display='none';
							Centrar(codProv, "1");
						}
					});
					
					$('#socio').on('change',function(){
						var codSocio = $(this).val();
						var codClub = $('#club').val();
						var codProv = $('#provincia').val();
						var anio = $('#anio').val();
						var psuelta = $('#psuelta').val();
						document.getElementById('btn_distancia').style.display='none';
						document.getElementById('datosdistancia').style.display='none';
						//Remove lines from Map
						polylines.forEach(function (item){
							map.removeLayer(item)
						});
						map.off('dblclick');
						BorrarPalomares();
						//BorrarPuntoSuelta();
						//$("#psuelta").val("-1").change();
						switch(parseInt(codSocio)){
							case -1:
								$("#centrarpalomar").prop("disabled", true);
								Centrar(codProv, "1");
								break;
							case 999:
								$("#centrarpalomar").prop("disabled", false);
								Centrar(codProv, "1");
								switch(parseInt(psuelta)){
									case -1:
										break;
									case 999:
										//document.getElementById('btn_distancia').style.display='none';
										//$("#btn_distancia").prop("disabled", true);
										break;
									default:
										document.getElementById('btn_distancia').style.display='block'; //DISTANCIA
										//$("#btn_distancia").prop("disabled", false);
								}
								TrataSocio(codSocio, psuelta, codProv);
								break;
							default:
								$("#centrarpalomar").prop("disabled", false);
								Centrar(codProv, "1");
								if (psuelta != -1){
									document.getElementById('btn_distancia').style.display='block'; //DISTANCIA
									//$("#btn_distancia").prop("disabled", false);
								}
								TrataSocio(codSocio, psuelta, codProv);
						}
					});
					
					$('#centrarpalomar').on('click',function(){
						var codSocio = $('#socio').val();
						var codProv = $('#provincia').val();
						CentraSocio(codSocio, codProv);
					});
					
					$('#psuelta').on('change',function(){
						var codSuelta = $(this).val();
						var anio = $('#anio').val();
						var codProv = $('#provincia').val();
						var codClub = $('#club').val();
						var codSocio = $('#socio').val();
						BorrarPuntoSuelta();
						polylines.forEach(function (item){
							map.removeLayer(item)
						});
						map.off('dblclick');
						document.getElementById('btn_distancia').style.display='none';
						document.getElementById('datosdistancia').style.display='none';
						document.getElementById('infopsuelta').style.display='none';
						switch (parseInt(codSuelta)){
							case -1:
								//document.getElementById('btn_distancia').style.display='none';
								//document.getElementById('datosdistancia').style.display='none';
								$("#centrarsuelta").prop("disabled", true);
								Centrar(codProv, "1");
								break;
							case 999:
								$("#centrarsuelta").prop("disabled", false);
								if ((codClub > 0)&&(codSocio != -1)&&(codSocio != 999)) {
									document.getElementById('btn_distancia').style.display='block'; //DISTANCIA
								}
								if (codSocio == 999) {
									//document.getElementById('datosdistancia').style.display='none';
									//$("#btn_distancia").prop("disabled", true);
								}
								TrataPuntoSuelta(anio, codProv, codClub, codSuelta);
								break;
							case 888:
								document.getElementById('infopsuelta').style.display='block';
								$("#centrarsuelta").prop("disabled", true);
								map.on('dblclick',function(e){
									//console.log("You clicked the map at LAT: "+ e.latlng.lat+" and LONG: "+e.latlng.lng);
									//Borramos las marcas creadas
									if (theMarker != undefined){
										map.removeLayer(theMarker);
									};
									polylines.forEach(function (item){
										map.removeLayer(item)
									});
									document.getElementById('btn_distancia').style.display='none';
									document.getElementById('datosdistancia').style.display='none';
									theMarker = marcarPuntoSueltaManual(e.latlng.lat, e.latlng.lng, codClub);
									if (theMarker != undefined){
										$("#centrarsuelta").prop("disabled", false);
										//Si no hay club ni socio seleccionado no hay botón de distancia
										if ((codClub != null)&&(codClub != -1)&&(codSocio != null)&&(codSocio != -1)){
											document.getElementById('btn_distancia').style.display='block'; //DISTANCIA
										}
									}
								});
								break;
							default:
								$("#centrarsuelta").prop("disabled", false);
								if ((codClub > 0)&&(codSocio > 0)) {
									document.getElementById('btn_distancia').style.display='block'; //DISTANCIA
									//$("#btn_distancia").prop("disabled", false);
								}
								TrataPuntoSuelta(anio, codProv, codClub, codSuelta);
						}
					});
					
					$('#centrarsuelta').on('click',function(){
						var codSuelta = $('#psuelta').val();
						var codSocio = $('#socio').val();
						if(codSuelta == 888){
							map.setView([theMarker._latlng.lat, theMarker._latlng.lng], 20, { animation: true });
						}
						else{
							CentraPuntoSuelta(codSuelta, codSocio);
						}
					});
					
					$('#btn_distancia').on('click',function(){
						var anio = $('#anio').val();
						var codProv = $('#provincia').val();
						var codClub = $('#club').val();
						var codSocio = $('#socio').val();
						var codSuelta = $('#psuelta').val();
						//Remove lines from Map
						polylines.forEach(function (item){
							map.removeLayer(item)
						});
						document.getElementById('infopsuelta').style.display='none';
						CalcularDistancia(anio, codProv, codClub, codSocio, codSuelta);
						document.getElementById('datosdistancia').style.display='block';
					});
					
					$("#aniosettings").slider({
						tooltip: 'always'
					});
					$('#centro').on('change',function(){
						var codCentro = $(this).val();
						var anio = $('#anio').val();
						document.getElementById('selectmartir').style.display='none';
						centers.forEach(function (item){
							map.removeLayer(item)
						});
						circles.forEach(function (item){
							map.removeLayer(item)
						});
						switch (parseInt(codCentro)){
							case -1:
								break;
							case 0: //centro provincia
								var miSelect = document.getElementById("martir");
								document.querySelector('#martir').innerHTML = '';
								var aTag = document.createElement('option');
								aTag.value = -1;
								aTag.text = "Seleccione provincia";
								miSelect.appendChild(aTag);
								for (var i=0; i<arrProvincias.length; i++){
									aTag = document.createElement('option');
									aTag.value = arrProvincias[i].codprov;
									aTag.text = arrProvincias[i].provclub;
									miSelect.appendChild(aTag);
								}
								document.getElementById('selectmartir').style.display='block';
								break;
							case 1: //palomar
								if (CargarTodosSocios(anio) > 0){
									var miSelect = document.getElementById("martir");
									document.querySelector('#martir').innerHTML = '';
									var aTag = document.createElement('option');
									aTag.value = -1;
									aTag.text = "Seleccione palomar";
									miSelect.appendChild(aTag);
									for (var i=0; i<arrAllSocios.length; i++){
										aTag = document.createElement('option');
										aTag.value = arrAllSocios[i].codsocio;
										aTag.text = "(" + arrAllSocios[i].numclub + ") "+ arrAllSocios[i].socio;
										miSelect.appendChild(aTag);
									}
									document.getElementById('selectmartir').style.display='block';
								}
								break;
							case 3: //palomar mas cercano
								var miSelect = document.getElementById("martir");
								document.querySelector('#martir').innerHTML = '';
								var aTag = document.createElement('option');
								aTag.value = -1;
								aTag.text = "Seleccione dirección";
								miSelect.appendChild(aTag);
								aTag = document.createElement('option');
								aTag.value = 1;
								aTag.text = "Norte";
								miSelect.appendChild(aTag);
								aTag = document.createElement('option');
								aTag.value = 2;
								aTag.text = "Sur";
								miSelect.appendChild(aTag);
								aTag = document.createElement('option');
								aTag.value = 3;
								aTag.text = "Este";
								miSelect.appendChild(aTag);
								aTag = document.createElement('option');
								aTag.value = 4;
								aTag.text = "Oeste";
								miSelect.appendChild(aTag);
								document.getElementById('selectmartir').style.display='block';
								break;
						}
					});
					$('#circlemap').on('click',function(){
						var radio = $('#rad_distancia').val();
						var codCentro = $('#centro').val();
						centers.forEach(function (item){
							map.removeLayer(item)
						});
						circles.forEach(function (item){
							map.removeLayer(item)
						});
						switch (parseInt(codCentro)){
							case 0: //centro provincia
								var codProvincia = $('#martir').val();
								if (codProvincia > 0){
									var coordenadas = dimeCentroProv(codProvincia);
									var micenter = L.circleMarker(coordenadas, {radius: 1,}).addTo(map);
									var micircle = L.circle(dimeCentroProv(codProvincia), {radius: radio*1000, color: 'red'}).addTo(map);
									micenter.setStyle({color: 'red'});
									centers.push(micenter);
									circles.push(micircle);
									micircle.bindPopup("Centro: "+coordenadas[0]+", "+coordenadas[1]+"<br />Radio: "+radio+" km");
								}
								break;
							case 1: //palomar
								var codSocio = $('#martir').val();
								if (codSocio > 0){
									var micenter = L.circleMarker([arrPalomares[codSocio].latgr.replace(",","."),arrPalomares[codSocio].longr.replace(",",".")], {radius: 1}).addTo(map);
									var micircle = L.circle([arrPalomares[codSocio].latgr.replace(",","."),arrPalomares[codSocio].longr.replace(",",".")], {radius: radio*1000, color: 'red'}).addTo(map);
									micenter.setStyle({color: 'red'});
									centers.push(micenter);
									circles.push(micircle);
									micircle.bindPopup("Centro: "+arrPalomares[codSocio].latgr.replace(",",".")+", "+arrPalomares[codSocio].longr.replace(",",".")+"<br />Radio: "+radio+" km");
								}
								break;
						}
					});
					$('#delcirclemap').on('click',function(){
						centers.forEach(function (item){
							map.removeLayer(item)
						});
						circles.forEach(function (item){
							map.removeLayer(item)
						});
					});
					$('#martir').on('change',function(){
						centers.forEach(function (item){
							map.removeLayer(item)
						});
						circles.forEach(function (item){
							map.removeLayer(item)
						});
					});
					
					map = L.map('map').setView([41.66, -4.72], 8);
					L.control.layers(baselayers).addTo(map);
					baselayers["Híbrido"].addTo(map);
					
					$(window).on("resize", function(){ $("#map").height($(window).height()-57); map.invalidateSize(); }).trigger("resize");
					
				</script>
				
			</div>
		</div>
	</body>
</html>
